import React, { useEffect, useState } from "react";
import { useLocation } from "react-router-dom"; // Ensures reactivity to URL changes
import prompt from "../Assets/signia-prompt.jpg";
import styletto from "../Assets/signia-styletto.jpg";
import defaultimg from "../Assets/image3.jpg";

// Define model mappings with bullet points
const modelMappings = {
  "signia prompt": {
    image: prompt,
    headline: "Signia Prompt 3X - Advanced Hearing Technology",
    bulletPoints: [
      "Crystal-clear sound quality",
      "Advanced noise cancellation",
      "Affordable and durable",
      "User-friendly controls",
    ],
  },
  "styletto signia": {
    image: styletto,
    headline: "Styletto Signia 3AX - Sleek and Powerful",
    bulletPoints: [
      "Ultra-slim modern design",
      "Bluetooth & AI-powered sound",
      "Rechargeable with fast charging",
      "Perfect for active lifestyles",
    ],
  },
};

// Default fallback
const defaultContent = {
  image: defaultimg,
  headline: "Best Hearing Aids in India – Compare Prices & Buy Signia Hearing Aids",
  bulletPoints: [
    "Nearly invisible design",
    "Bluetooth connectivity",
    "Rechargeable Machine",
    "0% EMI Options",
    "Special offers for Senior Citizens",
  ],
};

const ModalMapping = () => {
  const location = useLocation(); // Reactively get URL params
  const [matchedModel, setMatchedModel] = useState(defaultContent);

  useEffect(() => {
    // Extract search query from URL
    const urlParams = new URLSearchParams(location.search);
    const searchKeyword = urlParams.get("utm_term")?.toLowerCase().trim() || "";

    // Attempt to find a matching model
    let foundModel = defaultContent;
    for (const model in modelMappings) {
      if (searchKeyword.includes(model.toLowerCase())) {
        foundModel = modelMappings[model];
        break;
      }
    }

    setMatchedModel(foundModel);
  }, [location.search]); // Runs every time the URL changes

  return (
    <div>
      <h1 className="text-2xl md:text-4xl font-bold mt-6 mb-1">{matchedModel.headline}</h1>
      <img src={matchedModel.image} alt="Hearing Aid Model" className="w-full rounded-lg shadow-lg" />

      <ul className="mt-4 space-y-2 text-lg">
        {matchedModel.bulletPoints.map((point, index) => (
          <li key={index} className="flex items-center">
            <span className="text-blue-600 font-bold text-lg mr-2">✔</span>
            {point}
          </li>
        ))}
      </ul>
    </div>
  );
};

export default ModalMapping;
